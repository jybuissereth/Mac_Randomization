#!/bin/bash
tshark -r $1.pcap -T fields -E header=n -E separator=\; -e frame.time_relative -e wlan.sa -e frame.len -e  wlan.seq -e wlan.sa_resolved -e wlan.tag.length -e wlan.ssid -e wlan.tag.number -e wlan.tag.vendor.data -e wlan.ht.ampduparam.maxlength -e wlan.tag.vendor.oui.type -e wlan.tag.oui -e wlan.ht.capabilities.sm -e wlan.ht.capabilities.amsdu -e wlan.ht.capabilities.short20 -e wlan.ht.capabilities.dsscck -e wlan.ht.capabilities.rxstbc -e wlan.ds.current_channel -e wlan.supported_rates -e wlan.ht.ampduparam.mpdudensity -e wlan.ht.capabilities.green -e wlan.ht.mcsset.highestdatarate -e wlan.ht.mcsset.rxbitmask.8to15 -e wlan.ht.mcsset.txsetdefined -e wlan.ht.capabilities.short40 -e wlan.ht.mcsset.rxbitmask.16to23 -e wlan.htex.capabilities.htc -e wlan.ht.capabilities.width -e wlan.ht.capabilities.txstbc -e wlan.htex.capabilities.rdresponder -e wlan.ht.mcsset.rxbitmask.32 -e wlan.ht.capabilities.ldpccoding -e wlan.ht.mcsset.rxbitmask.0to7 -e wlan.htex.capabilities.transtime -e wlan.htex.capabilities.mcs -e wlan.ht.mcsset.txrxmcsnotequal -e wlan.ht.capabilities.40mhzintolerant -e wlan.txbf.txss -e wlan.txbf.txbf -e wlan.txbf.fm.uncompressed.maxant -e wlan.txbf.fm.compressed.tbf -e wlan.txbf.mingroup -e wlan.txbf.fm.uncompressed.tbf -e wlan.txbf.fm.compressed.maxant -e wlan.txbf.csi.maxrows -e wlan.txbf.rxss -e wlan.txbf.channelest -e wlan.txbf.fm.compressed.bf -e wlan.txbf.fm.uncompressed.rbf -e wlan.ht.mcsset.txmaxss -e wlan.ht.mcsset.rxbitmask.33to38 -e wlan.txbf.calibration -e wlan.htex.capabilities.pco -e wlan.txbf.csinumant -e wlan.txbf.rxndp -e wlan.ht.mcsset.txunequalmod -e wlan.txbf.txndp -e wlan.asel.txcsi -e wlan.ht.mcsset.rxbitmask.24to31 -e wlan.ht.mcsset.rxbitmask.39to52 -e wlan.asel.reserved -e wlan.asel.csi -e wlan.asel.if -e wlan.ht.capabilities.lsig -e wlan.asel.txif -e wlan.asel.rx -e wlan.txbf.impltxbf -e wlan.txbf.rcsi -e wlan.txbf.csi -e wlan.asel.sppdu -e wlan.txbf.reserved -e wlan.ht.capabilities.psmp -e wlan.asel.capable -e wlan.ht.mcsset.rxbitmask.53to76 -e wlan.ht.capabilities.delayedblockack -e wlan.ht.ampduparam.reserved -e wlan.wfa.ie.type -e wlan.vs.pren.type -e wlan.extended_supported_rates -e wps.uuid_e -e wps.device_name -e wps.length -e wps.model_name -e wps.model_number -e wps.manufacturer -e wps.config_methods -e wps.primary_device_type -e wps.config_methods.virt_display -e wps.config_methods.phy_display -e wps.rf_bands -e wps.config_methods.virt_pushbutton -e wps.config_methods.pushbutton -e wps.type -e wps.config_methods.keypad -e wps.config_methods.label -e wps.request_type -e wps.vendor_extension -e wps.ext.id -e wps.ext.len -e wps.config_methods.display -e wps.device_password_id -e wps.config_methods.phy_pushbutton -e wps.version -e wps.configuration_error -e wps.association_state -e wps.config_methods.usba -e wps.config_methods.nfcext -e wps.config_methods.ethernet -e wps.config_methods.nfcint -e wps.config_methods.nfcinf -e wps.vendor_id -e wps.ext.version2 -e wps.primary_device_type.category -e wifi_p2p.p2p_capability.device_capability -e wifi_p2p.listen_channel.channel_number -e wifi_p2p.p2p_capability.device_capability.concurrent_operation -e wifi_p2p.p2p_capability.device_capability.client_discoverability -e wifi_p2p.p2p_capability.device_capability.service_discovery -e wps.primary_device_type.subcategory_telephone -e wifi_p2p.listen_channel.country_string -e wifi_p2p.p2p_capability.group_capability -e wifi_p2p.p2p_capability.group_capability.intra_bss_distribution -e wifi_p2p.length -e wifi_p2p.type -e wifi_p2p.p2p_capability.device_capability.invitation_procedure -e wifi_p2p.p2p_capability.group_capability.persistent_reconnect -e wifi_p2p.p2p_capability.group_capability.group_limit -e wifi_p2p.p2p_capability.group_capability.cross_connection -e wifi_p2p.p2p_capability.group_capability.persistent_group -e wifi_p2p.p2p_capability.device_capability.device_limit -e wifi_p2p.p2p_capability.group_capability.group_formation -e wifi_p2p.listen_channel.operating_class -e wifi_p2p.p2p_capability.device_capability.infrastructure_managed -e wifi_p2p.p2p_capability.group_capability.group_owner -e wlan.extcap.b0 -e wlan.tag.data -e wlan.extcap.b1 -e wlan.extcap.b4 -e wlan.extcap.b2 -e wlan.extcap.b3 -e wlan.extcap.b5 -e wlan.extcap.b6 -e wlan.extcap.b7 -e _ws.expert.message -e _ws.expert.severity -e _ws.expert.group -e wlan.tag.data.undecoded -e wps.primary_device_type.subcategory_computer -e wlan.tag.length.bad -e wps.uuid_r -e wlan.vs.nintendo.service -e wlan.vs.nintendo.consoleid -e wlan.vs.nintendo.length -e wlan.vht.mcsset.rxmcsmap.ss1 -e wlan.vht.mcsset.txmcsmap.ss1 -e wlan.vht.mcsset.rxhighestlonggirate -e wlan.vht.capabilities.maxmpdulength -e wlan.vht.capabilities.rxldpc -e wlan.vht.mcsset.txmcsmap.ss8 -e wlan.vht.mcsset.rxmcsmap.ss8 -e wlan.vht.mcsset.rxmcsmap.ss3 -e wlan.vht.capabilities.rxpatconsist -e wlan.vht.mcsset.rxmcsmap.ss7 -e wlan.vht.mcsset.rxmcsmap.ss6 -e wlan.vht.capabilities.mubeamformer -e wlan.vht.mcsset.txmcsmap.ss2 -e wlan.vht.capabilities.txstbc -e wlan.vht.capabilities.supportedchanwidthset -e wlan.vht.capabilities.soundingdimensions -e wlan.vht.capabilities.vhthtc -e wlan.vht.capabilities.short80 -e wlan.vht.capabilities.linkadapt -e wlan.vht.capabilities.maxampdu -e wlan.vht.capabilities.vhttxopps -e wlan.vht.capabilities.subeamformer -e wlan.vht.capabilities.txpatconsist -e wlan.vht.capabilities.rxstbc -e wlan.vht.mcsset.rxmcsmap.ss5 -e wlan.vht.capabilities.subeamformee -e wlan.vht.mcsset.rxmcsmap.ss4 -e wlan.vht.mcsset.txhighestlonggirate -e wlan.vht.mcsset.txmcsmap.ss3 -e wlan.vht.capabilities.short160 -e wlan.vht.capabilities.mubeamformee -e wlan.vht.mcsset.rxmcsmap.ss2 -e wlan.vht.mcsset.txmcsmap.ss5 -e wlan.vht.mcsset.txmcsmap.ss4 -e wlan.vht.mcsset.txmcsmap.ss7 -e wlan.vht.mcsset.txmcsmap.ss6 -e wlan.vs.nintendo.type -e wlan.tag.request -e wps.ext.request_to_enroll -e wlan.extcap.b19 -e wlan.extcap.b9 -e wlan.extcap.b25 -e wlan.extcap.b38 -e wlan.extcap.b39 -e wlan.extcap.b30 -e wlan.extcap.b31 -e wlan.extcap.b32 -e wlan.extcap.b33 -e wlan.extcap.b34 -e wlan.extcap.b36 -e wlan.extcap.b37 -e wlan.extcap.b29 -e wlan.extcap.b28 -e wlan.extcap.b20 -e wlan.extcap.b12 -e wlan.extcap.b27 -e wlan.extcap.b24 -e wlan.extcap.b15 -e wlan.extcap.b26 -e wlan.extcap.b23 -e wlan.extcap.b8 -e wlan.extcap.b22 -e wlan.extcap.b18 -e wlan.extcap.b21 -e wlan.extcap.b35 -e wlan.extcap.b14 -e wlan.extcap.b13 -e wlan.extcap.b10 -e wlan.extcap.b11 -e wlan.extcap.b16 -e wlan.extcap.b17 -e wlan.rsn.gcs.type -e wlan.rsn.pcs.count -e wlan.rsn.version -e wlan.rsn.capabilities.jmr -e wlan.rsn.capabilities.peerkey -e wlan.rsn.capabilities.mfpc -e wlan.rsn.capabilities.mfpr -e wlan.rsn.pcs.oui -e wlan.rsn.akms.type -e wlan.rsn.capabilities.gtksa_replay_counter -e wlan.rsn.capabilities.ptksa_replay_counter -e wlan.rsn.gcs.oui -e wlan.rsn.capabilities.preauth -e wlan.rsn.pcs.type -e wlan.rsn.akms.count -e wlan.rsn.akms.oui -e wlan.rsn.capabilities.no_pairwise -e wps.primary_device_type.subcategory_displays -e wlan.extcap.b62 -e wlan.extcap.b48 -e wlan.extcap.b40 -e wlan.extcap.b45 -e wlan.extcap.b47 -e wlan.extcap.b44 -e wlan.extcap.b46 -e wlan.extcap.serv_int_granularity -e wlan.extcap.b63 -e wlan.extcap.b61 -e wlan.ric_desc.rsrc_type -e wifi_display.subelem.dev_info.max_throughput -e wifi_display.subelem.dev_info.content_protection -e wifi_display.subelem.dev_info.control_port -e wifi_display.subelem.session.reserved -e wifi_display.subelem.dev_info.coupled_sink_by_sink -e wifi_display.subelem.session.tdls_persistent_group -e wifi_display.subelem.session.audio_unsupp_pri_sink -e wifi_display.subelem.dev_info.pc -e wifi_display.subelem.length -e wifi_display.subelem.dev_info.wsd -e wifi_display.subelem.session.tdls_persistent_group_reinvoke -e wifi_display.subelem.id -e wifi_display.subelem.dev_info.time_sync -e wifi_display.subelem.dev_info.available -e wifi_display.subelem.dev_info.type -e wifi_display.subelem.session.audio_only_supp_source -e wifi_display.subelem.dev_info.coupled_sink_by_source > $1_dataset
echo Done!
